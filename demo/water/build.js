!function(t){function a(e){if(r[e])return r[e].exports;var n=r[e]={exports:{},id:e,loaded:!1};return t[e].call(n.exports,n,n.exports,a),n.loaded=!0,n.exports}var r={};return a.m=t,a.c=r,a.p="",a(0)}([function(t,a,r){"use strict";function e(t){if(t&&t.__esModule)return t;var a={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(a[r]=t[r]);return a.default=t,a}function n(t){return t&&t.__esModule?t:{default:t}}function o(){requestAnimationFrame(o),u(),i()}function u(){D.updateStep()}function i(){I.enable(I.DEPTH_TEST),F.render(D),I.disable(I.DEPTH_TEST)}var l=r(10),s=n(l),M=r(9),f=n(M),h=r(5),c=e(h),x=document.querySelector("#canvas"),S=window.devicePixelRatio||1,d=window.innerWidth,m=window.innerHeight;x.width=d*S,x.height=m*S,x.style.width=d+"px",x.style.height=m+"px";for(var I=c.getContext(x),D=new s.default(I),F=new f.default(I),v=0;v<20;v++)D.addDrop(2*Math.random()-1,2*Math.random()-1,.03,1&v?.01:-.01);o()},function(t,a){var r={};r.EPSILON=1e-6,r.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,r.RANDOM=Math.random,r.ENABLE_SIMD=!1,r.SIMD_AVAILABLE=r.ARRAY_TYPE===Float32Array&&"SIMD"in this,r.USE_SIMD=r.ENABLE_SIMD&&r.SIMD_AVAILABLE,r.setMatrixArrayType=function(t){r.ARRAY_TYPE=t};var e=Math.PI/180;r.toRadian=function(t){return t*e},r.equals=function(t,a){return Math.abs(t-a)<=r.EPSILON*Math.max(1,Math.abs(t),Math.abs(a))},t.exports=r},function(t,a){"use strict";function r(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var e=function(){function t(t,a){for(var r=0;r<a.length;r++){var e=a[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(a,r,e){return r&&t(a.prototype,r),e&&t(a,e),a}}(),n=function(){function t(a,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r(this,t),this.gl=a,this.buffer=a.createBuffer(),this.type_=e,this.dataType_=n.dataType||a.FLOAT,this.drawType_=n.drawType||a.STATIC_DRAW}return e(t,[{key:"write",value:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.gl,e=this.buffer,n=this.type_,o=this.drawType_;r.bindBuffer(n,e),r.bufferData(n,t,o),r.bindBuffer(n,null),this.data=t,this.size=a,this.length=t.length}},{key:"bind",value:function(t){var a=this.gl,r=this.buffer,e=this.size,n=this.type_,o=this.dataType_;switch(n){case a.ARRAY_BUFFER:a.bindBuffer(n,r),a.enableVertexAttribArray(t),a.vertexAttribPointer(t,e,o,!1,0,0);break;case a.ELEMENT_ARRAY_BUFFER:a.bindBuffer(n,r)}}},{key:"drop",value:function(){var t=this.gl,a=this.buffer;t.deleteBuffer(a),this.gl=null,this.buffer=null,this.data=null,this.size=0,this.length=0,this.type_=0}}]),t}();a.default=n},function(t,a){"use strict";function r(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var e=function(){function t(t,a){for(var r=0;r<a.length;r++){var e=a[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(a,r,e){return r&&t(a.prototype,r),e&&t(a,e),a}}(),n=function(){function t(a,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r(this,t),this.gl=a,this.texture=a.createTexture(),this.type_=e,this.unit_=n.unit||0,this.level_=n.level||0,this.width_=n.width||0,this.height_=n.height||0,this.dataType_=n.dataType||a.UNSIGNED_BYTE,this.colorType_=n.colorType||a.RGBA,this.minFilter_=n.minFilter||n.filter||a.LINEAR,this.magFilter_=n.magFilter||n.filter||a.LINEAR,this.wrapS_=n.wrapS||n.wrap||a.CLAMP_TO_EDGE,this.wrapT_=n.wrapT||n.wrap||a.CLAMP_TO_EDGE,this.config_()}return e(t,[{key:"config_",value:function(){var t=this.gl,a=this.texture,r=this.type_,e=this.level_,n=this.width_,o=this.height_,u=this.dataType_,i=this.colorType_,l=this.minFilter_,s=this.magFilter_,M=this.wrapS_,f=this.wrapT_;t.bindTexture(r,a),t.texParameteri(r,t.TEXTURE_MIN_FILTER,l),t.texParameteri(r,t.TEXTURE_MAG_FILTER,s),t.texParameteri(r,t.TEXTURE_WRAP_S,M),t.texParameteri(r,t.TEXTURE_WRAP_T,f),t.texImage2D(r,e,i,n,o,0,i,u,null),t.bindTexture(r,null)}},{key:"write",value:function(t){var a=this.gl,r=this.texture,e=this.type_,n=this.level_,o=this.width_,u=this.height_,i=this.dataType_,l=this.colorType_;if("function"!=typeof t)a.bindTexture(e,r),a.texImage2D(e,n,l,l,i,t),a.bindTexture(e,null),this.data=t;else{var s=a.getParameter(a.VIEWPORT),M=a.createFramebuffer(),f=a.createRenderbuffer();a.bindFramebuffer(a.FRAMEBUFFER,M),a.bindRenderbuffer(a.RENDERBUFFER,f),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,o,u),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,e,r,n),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,f);var h=a.checkFramebufferStatus(a.FRAMEBUFFER);if(h!==a.FRAMEBUFFER_COMPLETE)throw Error("Rendering to this texture is not supported (incomplete framebuffer)");a.viewport.apply(a,[0,0,o,u]),t(),a.viewport.apply(a,s),a.bindRenderbuffer(a.RENDERBUFFER,null),a.deleteRenderbuffer(f),a.bindFramebuffer(a.FRAMEBUFFER,null),a.deleteFramebuffer(M),this.data=null}}},{key:"bind",value:function(t){var a=this.gl,r=this.texture,e=this.type_,n=this.unit_;a.activeTexture(a.TEXTURE0+n),a.bindTexture(e,r),a.uniform1i(t,n)}},{key:"drop",value:function(){var t=this.gl,a=this.texture;t.deleteTexture(a),this.gl=null,this.texture=null,this.data=null,this.type_=0,this.unit_=0}}]),t}();a.default=n},function(t,a,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function n(t,a,r){return a in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t}function o(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function u(t){var a=Object.prototype.toString.call(t);return"[object Number]"==a||"[object Boolean]"==a}function i(t){var a=Object.prototype.toString.call(t);return"[object Array]"==a||"[object Float32Array]"==a}function l(t){return t instanceof h.default}function s(t){return t instanceof x.default}Object.defineProperty(a,"__esModule",{value:!0});var M=function(){function t(t,a){for(var r=0;r<a.length;r++){var e=a[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(a,r,e){return r&&t(a.prototype,r),e&&t(a,e),a}}(),f=r(2),h=e(f),c=r(3),x=e(c),S=function(){function t(a){o(this,t),this.gl=a,this.program=a.createProgram(),this.first_=!0}return M(t,[{key:"extractAttribs_",value:function(){for(var t=this.gl,a=this.program,r=this.attribs_||(this.attribs_={}),e=t.getProgramParameter(a,t.ACTIVE_ATTRIBUTES),n=0;n<e;n++){var o=t.getActiveAttrib(a,n),u=o.name;r[u]=t.getAttribLocation(a,u)}}},{key:"extractUniforms_",value:function(){for(var t=this.gl,a=this.program,r=this.uniforms_||(this.uniforms_={}),e=t.getProgramParameter(a,t.ACTIVE_UNIFORMS),n=0;n<e;n++){var o=t.getActiveUniform(a,n),u=o.name.replace("[0]","");r[u]=t.getUniformLocation(a,u)}}},{key:"attach",value:function(t,a){var r=this.gl,e=this.program,n=void 0;switch(a){case r.VERTEX_SHADER:n=this.vertexShader_=r.createShader(a);break;case r.FRAGMENT_SHADER:n=this.fragmentShader_=r.createShader(a)}r.attachShader(e,n),r.shaderSource(n,t),r.compileShader(n);var o=r.getShaderParameter(n,r.COMPILE_STATUS),u=r.getShaderInfoLog(n);if(!o)throw r.deleteShader(n),Error(u)}},{key:"link",value:function(){var t=this.gl,a=this.program;t.linkProgram(a);var r=t.getProgramParameter(a,t.LINK_STATUS),e=t.getProgramInfoLog(a);if(!r)throw t.deleteProgram(a),Error(e)}},{key:"attrib",value:function(t){var a=this.gl,r=this.attribs_||{};if(2===arguments.length){var e=arguments[0],o=arguments[1];t=n({},e,o)}Object.keys(t).forEach(function(e){var n=t[e],o=r[e];if(void 0!==o)if(i(n))switch(n.length){case 1:a.vertexAttrib1fv(o,n);break;case 2:a.vertexAttrib2fv(o,n);break;case 3:a.vertexAttrib3fv(o,n);break;case 4:a.vertexAttrib4fv(o,n);break;default:throw Error("don't know how to load attribute \""+e+'" of length '+n.length)}else if(u(n))a.vertexAttrib1f(o,n);else{if(!l(n))throw Error('attempted to set attribute "'+e+'" to invalid value '+n);n.bind(o)}})}},{key:"uniform",value:function(t){var a=this.gl,r=this.uniforms_;if(2===arguments.length){var e=arguments[0],o=arguments[1];t=n({},e,o)}Object.keys(t).forEach(function(e){var n=t[e],o=r[e];if(void 0!==o)if(i(n))switch(n.length){case 1:a.uniform1fv(o,n);break;case 2:a.uniform2fv(o,n);break;case 3:a.uniform3fv(o,n);break;case 4:a.uniform4fv(o,n);break;case 9:a.uniformMatrix3fv(o,!1,n);case 16:a.uniformMatrix4fv(o,!1,n);break;default:throw Error("don't know how to load uniform \""+e+'" of length '+n.length)}else if(u(n))a.uniform1f(o,n);else{if(!s(n))throw Error('attempted to set attribute "'+e+'" to invalid value '+n);n.bind(o)}})}},{key:"bind",value:function(){var t=this.gl,a=this.program,r=this.vertexShader_,e=this.fragmentShader_,n=this.first_;n&&(this.extractAttribs_(),this.extractUniforms_(),t.deleteShader(r),t.deleteShader(e),this.first_=!1,this.vertexShader_=null,this.fragmentShader_=null),t.useProgram(a)}},{key:"draw",value:function(t){var a=this.gl;a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),l(t)?(t.bind(),a.drawElements(a.TRIANGLES,t.length,a.UNSIGNED_SHORT,0)):(t=+t||0,a.drawArrays(a.TRIANGLES,0,t))}},{key:"drop",value:function(){var t=this.gl,a=this.program;t.deleteProgram(a),this.gl=null,this.program=null,this.attribs={},this.uniforms={},this.first_=!0}}]),t}();a.default=S},function(t,a){"use strict";function r(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.getContext("webgl",a)||t.getContext("experimental-webgl",a)}function e(t){return!!t.getExtension("OES_texture_float")}function n(t){return!!t.getExtension("OES_texture_float_linear")}function o(t){var a=t.getExtension("OES_texture_half_float");return a&&(t.HALF_FLOAT_OES=a.HALF_FLOAT_OES),a}function u(t){return!!t.getExtension("OES_texture_half_float_linear")}Object.defineProperty(a,"__esModule",{value:!0}),a.getContext=r,a.canUseFloatingPointTexture=e,a.canUseFloatingPointLinearFiltering=n,a.canUseHalfFloatingPointTexture=o,a.canUseHalfFloatingPointLinearFiltering=u},function(t,a,r){var e=r(1),n={};n.create=function(){var t=new e.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.fromMat4=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[4],t[4]=a[5],t[5]=a[6],t[6]=a[8],t[7]=a[9],t[8]=a[10],t},n.clone=function(t){var a=new e.ARRAY_TYPE(9);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a},n.copy=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t},n.fromValues=function(t,a,r,n,o,u,i,l,s){var M=new e.ARRAY_TYPE(9);return M[0]=t,M[1]=a,M[2]=r,M[3]=n,M[4]=o,M[5]=u,M[6]=i,M[7]=l,M[8]=s,M},n.set=function(t,a,r,e,n,o,u,i,l,s){return t[0]=a,t[1]=r,t[2]=e,t[3]=n,t[4]=o,t[5]=u,t[6]=i,t[7]=l,t[8]=s,t},n.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.transpose=function(t,a){if(t===a){var r=a[1],e=a[2],n=a[5];t[1]=a[3],t[2]=a[6],t[3]=r,t[5]=a[7],t[6]=e,t[7]=n}else t[0]=a[0],t[1]=a[3],t[2]=a[6],t[3]=a[1],t[4]=a[4],t[5]=a[7],t[6]=a[2],t[7]=a[5],t[8]=a[8];return t},n.invert=function(t,a){var r=a[0],e=a[1],n=a[2],o=a[3],u=a[4],i=a[5],l=a[6],s=a[7],M=a[8],f=M*u-i*s,h=-M*o+i*l,c=s*o-u*l,x=r*f+e*h+n*c;return x?(x=1/x,t[0]=f*x,t[1]=(-M*e+n*s)*x,t[2]=(i*e-n*u)*x,t[3]=h*x,t[4]=(M*r-n*l)*x,t[5]=(-i*r+n*o)*x,t[6]=c*x,t[7]=(-s*r+e*l)*x,t[8]=(u*r-e*o)*x,t):null},n.adjoint=function(t,a){var r=a[0],e=a[1],n=a[2],o=a[3],u=a[4],i=a[5],l=a[6],s=a[7],M=a[8];return t[0]=u*M-i*s,t[1]=n*s-e*M,t[2]=e*i-n*u,t[3]=i*l-o*M,t[4]=r*M-n*l,t[5]=n*o-r*i,t[6]=o*s-u*l,t[7]=e*l-r*s,t[8]=r*u-e*o,t},n.determinant=function(t){var a=t[0],r=t[1],e=t[2],n=t[3],o=t[4],u=t[5],i=t[6],l=t[7],s=t[8];return a*(s*o-u*l)+r*(-s*n+u*i)+e*(l*n-o*i)},n.multiply=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=a[3],i=a[4],l=a[5],s=a[6],M=a[7],f=a[8],h=r[0],c=r[1],x=r[2],S=r[3],d=r[4],m=r[5],I=r[6],D=r[7],F=r[8];return t[0]=h*e+c*u+x*s,t[1]=h*n+c*i+x*M,t[2]=h*o+c*l+x*f,t[3]=S*e+d*u+m*s,t[4]=S*n+d*i+m*M,t[5]=S*o+d*l+m*f,t[6]=I*e+D*u+F*s,t[7]=I*n+D*i+F*M,t[8]=I*o+D*l+F*f,t},n.mul=n.multiply,n.translate=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=a[3],i=a[4],l=a[5],s=a[6],M=a[7],f=a[8],h=r[0],c=r[1];return t[0]=e,t[1]=n,t[2]=o,t[3]=u,t[4]=i,t[5]=l,t[6]=h*e+c*u+s,t[7]=h*n+c*i+M,t[8]=h*o+c*l+f,t},n.rotate=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=a[3],i=a[4],l=a[5],s=a[6],M=a[7],f=a[8],h=Math.sin(r),c=Math.cos(r);return t[0]=c*e+h*u,t[1]=c*n+h*i,t[2]=c*o+h*l,t[3]=c*u-h*e,t[4]=c*i-h*n,t[5]=c*l-h*o,t[6]=s,t[7]=M,t[8]=f,t},n.scale=function(t,a,r){var e=r[0],n=r[1];return t[0]=e*a[0],t[1]=e*a[1],t[2]=e*a[2],t[3]=n*a[3],t[4]=n*a[4],t[5]=n*a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t},n.fromTranslation=function(t,a){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=a[0],t[7]=a[1],t[8]=1,t},n.fromRotation=function(t,a){var r=Math.sin(a),e=Math.cos(a);return t[0]=e,t[1]=r,t[2]=0,t[3]=-r,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.fromScaling=function(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=0,t[4]=a[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},n.fromMat2d=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=0,t[3]=a[2],t[4]=a[3],t[5]=0,t[6]=a[4],t[7]=a[5],t[8]=1,t},n.fromQuat=function(t,a){var r=a[0],e=a[1],n=a[2],o=a[3],u=r+r,i=e+e,l=n+n,s=r*u,M=e*u,f=e*i,h=n*u,c=n*i,x=n*l,S=o*u,d=o*i,m=o*l;return t[0]=1-f-x,t[3]=M-m,t[6]=h+d,t[1]=M+m,t[4]=1-s-x,t[7]=c-S,t[2]=h-d,t[5]=c+S,t[8]=1-s-f,t},n.normalFromMat4=function(t,a){var r=a[0],e=a[1],n=a[2],o=a[3],u=a[4],i=a[5],l=a[6],s=a[7],M=a[8],f=a[9],h=a[10],c=a[11],x=a[12],S=a[13],d=a[14],m=a[15],I=r*i-e*u,D=r*l-n*u,F=r*s-o*u,v=e*l-n*i,b=e*s-o*i,_=n*s-o*l,p=M*S-f*x,E=M*d-h*x,g=M*m-c*x,w=f*d-h*S,A=f*m-c*S,T=h*m-c*d,y=I*T-D*A+F*w+v*g-b*E+_*p;return y?(y=1/y,t[0]=(i*T-l*A+s*w)*y,t[1]=(l*g-u*T-s*E)*y,t[2]=(u*A-i*g+s*p)*y,t[3]=(n*A-e*T-o*w)*y,t[4]=(r*T-n*g+o*E)*y,t[5]=(e*g-r*A-o*p)*y,t[6]=(S*_-d*b+m*v)*y,t[7]=(d*F-x*_-m*D)*y,t[8]=(x*b-S*F+m*I)*y,t):null},n.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},n.add=function(t,a,r){return t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t[3]=a[3]+r[3],t[4]=a[4]+r[4],t[5]=a[5]+r[5],t[6]=a[6]+r[6],t[7]=a[7]+r[7],t[8]=a[8]+r[8],t},n.subtract=function(t,a,r){return t[0]=a[0]-r[0],t[1]=a[1]-r[1],t[2]=a[2]-r[2],t[3]=a[3]-r[3],t[4]=a[4]-r[4],t[5]=a[5]-r[5],t[6]=a[6]-r[6],t[7]=a[7]-r[7],t[8]=a[8]-r[8],t},n.sub=n.subtract,n.multiplyScalar=function(t,a,r){return t[0]=a[0]*r,t[1]=a[1]*r,t[2]=a[2]*r,t[3]=a[3]*r,t[4]=a[4]*r,t[5]=a[5]*r,t[6]=a[6]*r,t[7]=a[7]*r,t[8]=a[8]*r,t},n.multiplyScalarAndAdd=function(t,a,r,e){return t[0]=a[0]+r[0]*e,t[1]=a[1]+r[1]*e,t[2]=a[2]+r[2]*e,t[3]=a[3]+r[3]*e,t[4]=a[4]+r[4]*e,t[5]=a[5]+r[5]*e,t[6]=a[6]+r[6]*e,t[7]=a[7]+r[7]*e,t[8]=a[8]+r[8]*e,t},n.exactEquals=function(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]&&t[6]===a[6]&&t[7]===a[7]&&t[8]===a[8]},n.equals=function(t,a){var r=t[0],n=t[1],o=t[2],u=t[3],i=t[4],l=t[5],s=t[6],M=t[7],f=t[8],h=a[0],c=a[1],x=a[2],S=a[3],d=a[4],m=a[5],I=t[6],D=a[7],F=a[8];return Math.abs(r-h)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-c)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(o-x)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(x))&&Math.abs(u-S)<=e.EPSILON*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(i-d)<=e.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(l-m)<=e.EPSILON*Math.max(1,Math.abs(l),Math.abs(m))&&Math.abs(s-I)<=e.EPSILON*Math.max(1,Math.abs(s),Math.abs(I))&&Math.abs(M-D)<=e.EPSILON*Math.max(1,Math.abs(M),Math.abs(D))&&Math.abs(f-F)<=e.EPSILON*Math.max(1,Math.abs(f),Math.abs(F))},t.exports=n},function(t,a,r){var e=r(1),n={};n.create=function(){var t=new e.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t},n.clone=function(t){var a=new e.ARRAY_TYPE(3);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a},n.fromValues=function(t,a,r){var n=new e.ARRAY_TYPE(3);return n[0]=t,n[1]=a,n[2]=r,n},n.copy=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t},n.set=function(t,a,r,e){return t[0]=a,t[1]=r,t[2]=e,t},n.add=function(t,a,r){return t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},n.subtract=function(t,a,r){return t[0]=a[0]-r[0],t[1]=a[1]-r[1],t[2]=a[2]-r[2],t},n.sub=n.subtract,n.multiply=function(t,a,r){return t[0]=a[0]*r[0],t[1]=a[1]*r[1],t[2]=a[2]*r[2],t},n.mul=n.multiply,n.divide=function(t,a,r){return t[0]=a[0]/r[0],t[1]=a[1]/r[1],t[2]=a[2]/r[2],t},n.div=n.divide,n.ceil=function(t,a){return t[0]=Math.ceil(a[0]),t[1]=Math.ceil(a[1]),t[2]=Math.ceil(a[2]),t},n.floor=function(t,a){return t[0]=Math.floor(a[0]),t[1]=Math.floor(a[1]),t[2]=Math.floor(a[2]),t},n.min=function(t,a,r){return t[0]=Math.min(a[0],r[0]),t[1]=Math.min(a[1],r[1]),t[2]=Math.min(a[2],r[2]),t},n.max=function(t,a,r){return t[0]=Math.max(a[0],r[0]),t[1]=Math.max(a[1],r[1]),t[2]=Math.max(a[2],r[2]),t},n.round=function(t,a){return t[0]=Math.round(a[0]),t[1]=Math.round(a[1]),t[2]=Math.round(a[2]),t},n.scale=function(t,a,r){return t[0]=a[0]*r,t[1]=a[1]*r,t[2]=a[2]*r,t},n.scaleAndAdd=function(t,a,r,e){return t[0]=a[0]+r[0]*e,t[1]=a[1]+r[1]*e,t[2]=a[2]+r[2]*e,t},n.distance=function(t,a){var r=a[0]-t[0],e=a[1]-t[1],n=a[2]-t[2];return Math.sqrt(r*r+e*e+n*n)},n.dist=n.distance,n.squaredDistance=function(t,a){var r=a[0]-t[0],e=a[1]-t[1],n=a[2]-t[2];return r*r+e*e+n*n},n.sqrDist=n.squaredDistance,n.length=function(t){var a=t[0],r=t[1],e=t[2];return Math.sqrt(a*a+r*r+e*e)},n.len=n.length,n.squaredLength=function(t){var a=t[0],r=t[1],e=t[2];return a*a+r*r+e*e},n.sqrLen=n.squaredLength,n.negate=function(t,a){return t[0]=-a[0],t[1]=-a[1],t[2]=-a[2],t},n.inverse=function(t,a){return t[0]=1/a[0],t[1]=1/a[1],t[2]=1/a[2],t},n.normalize=function(t,a){var r=a[0],e=a[1],n=a[2],o=r*r+e*e+n*n;return o>0&&(o=1/Math.sqrt(o),t[0]=a[0]*o,t[1]=a[1]*o,t[2]=a[2]*o),t},n.dot=function(t,a){return t[0]*a[0]+t[1]*a[1]+t[2]*a[2]},n.cross=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=r[0],i=r[1],l=r[2];return t[0]=n*l-o*i,t[1]=o*u-e*l,t[2]=e*i-n*u,t},n.lerp=function(t,a,r,e){var n=a[0],o=a[1],u=a[2];return t[0]=n+e*(r[0]-n),t[1]=o+e*(r[1]-o),t[2]=u+e*(r[2]-u),t},n.hermite=function(t,a,r,e,n,o){var u=o*o,i=u*(2*o-3)+1,l=u*(o-2)+o,s=u*(o-1),M=u*(3-2*o);return t[0]=a[0]*i+r[0]*l+e[0]*s+n[0]*M,t[1]=a[1]*i+r[1]*l+e[1]*s+n[1]*M,t[2]=a[2]*i+r[2]*l+e[2]*s+n[2]*M,t},n.bezier=function(t,a,r,e,n,o){var u=1-o,i=u*u,l=o*o,s=i*u,M=3*o*i,f=3*l*u,h=l*o;return t[0]=a[0]*s+r[0]*M+e[0]*f+n[0]*h,t[1]=a[1]*s+r[1]*M+e[1]*f+n[1]*h,t[2]=a[2]*s+r[2]*M+e[2]*f+n[2]*h,t},n.random=function(t,a){a=a||1;var r=2*e.RANDOM()*Math.PI,n=2*e.RANDOM()-1,o=Math.sqrt(1-n*n)*a;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=n*a,t},n.transformMat4=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=r[3]*e+r[7]*n+r[11]*o+r[15];return u=u||1,t[0]=(r[0]*e+r[4]*n+r[8]*o+r[12])/u,t[1]=(r[1]*e+r[5]*n+r[9]*o+r[13])/u,t[2]=(r[2]*e+r[6]*n+r[10]*o+r[14])/u,t},n.transformMat3=function(t,a,r){var e=a[0],n=a[1],o=a[2];return t[0]=e*r[0]+n*r[3]+o*r[6],t[1]=e*r[1]+n*r[4]+o*r[7],t[2]=e*r[2]+n*r[5]+o*r[8],t},n.transformQuat=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=r[0],i=r[1],l=r[2],s=r[3],M=s*e+i*o-l*n,f=s*n+l*e-u*o,h=s*o+u*n-i*e,c=-u*e-i*n-l*o;return t[0]=M*s+c*-u+f*-l-h*-i,t[1]=f*s+c*-i+h*-u-M*-l,t[2]=h*s+c*-l+M*-i-f*-u,t},n.rotateX=function(t,a,r,e){var n=[],o=[];return n[0]=a[0]-r[0],n[1]=a[1]-r[1],n[2]=a[2]-r[2],o[0]=n[0],o[1]=n[1]*Math.cos(e)-n[2]*Math.sin(e),o[2]=n[1]*Math.sin(e)+n[2]*Math.cos(e),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},n.rotateY=function(t,a,r,e){var n=[],o=[];return n[0]=a[0]-r[0],n[1]=a[1]-r[1],n[2]=a[2]-r[2],o[0]=n[2]*Math.sin(e)+n[0]*Math.cos(e),o[1]=n[1],o[2]=n[2]*Math.cos(e)-n[0]*Math.sin(e),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},n.rotateZ=function(t,a,r,e){var n=[],o=[];return n[0]=a[0]-r[0],n[1]=a[1]-r[1],n[2]=a[2]-r[2],o[0]=n[0]*Math.cos(e)-n[1]*Math.sin(e),o[1]=n[0]*Math.sin(e)+n[1]*Math.cos(e),o[2]=n[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},n.forEach=function(){var t=n.create();return function(a,r,e,n,o,u){var i,l;for(r||(r=3),e||(e=0),l=n?Math.min(n*r+e,a.length):a.length,i=e;i<l;i+=r)t[0]=a[i],t[1]=a[i+1],t[2]=a[i+2],o(t,t,u),a[i]=t[0],a[i+1]=t[1],a[i+2]=t[2];return a}}(),n.angle=function(t,a){var r=n.fromValues(t[0],t[1],t[2]),e=n.fromValues(a[0],a[1],a[2]);n.normalize(r,r),n.normalize(e,e);var o=n.dot(r,e);return o>1?0:Math.acos(o)},n.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},n.exactEquals=function(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]},n.equals=function(t,a){var r=t[0],n=t[1],o=t[2],u=a[0],i=a[1],l=a[2];return Math.abs(r-u)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-i)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(o-l)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(l))},t.exports=n},function(t,a,r){var e=r(1),n={};n.create=function(){var t=new e.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},n.clone=function(t){var a=new e.ARRAY_TYPE(4);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a},n.fromValues=function(t,a,r,n){var o=new e.ARRAY_TYPE(4);return o[0]=t,o[1]=a,o[2]=r,o[3]=n,o},n.copy=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t},n.set=function(t,a,r,e,n){return t[0]=a,t[1]=r,t[2]=e,t[3]=n,t},n.add=function(t,a,r){return t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t[3]=a[3]+r[3],t},n.subtract=function(t,a,r){return t[0]=a[0]-r[0],t[1]=a[1]-r[1],t[2]=a[2]-r[2],t[3]=a[3]-r[3],t},n.sub=n.subtract,n.multiply=function(t,a,r){return t[0]=a[0]*r[0],t[1]=a[1]*r[1],t[2]=a[2]*r[2],t[3]=a[3]*r[3],t},n.mul=n.multiply,n.divide=function(t,a,r){return t[0]=a[0]/r[0],t[1]=a[1]/r[1],t[2]=a[2]/r[2],t[3]=a[3]/r[3],t},n.div=n.divide,n.ceil=function(t,a){return t[0]=Math.ceil(a[0]),t[1]=Math.ceil(a[1]),t[2]=Math.ceil(a[2]),t[3]=Math.ceil(a[3]),t},n.floor=function(t,a){return t[0]=Math.floor(a[0]),t[1]=Math.floor(a[1]),t[2]=Math.floor(a[2]),t[3]=Math.floor(a[3]),t},n.min=function(t,a,r){return t[0]=Math.min(a[0],r[0]),t[1]=Math.min(a[1],r[1]),t[2]=Math.min(a[2],r[2]),t[3]=Math.min(a[3],r[3]),t},n.max=function(t,a,r){return t[0]=Math.max(a[0],r[0]),t[1]=Math.max(a[1],r[1]),t[2]=Math.max(a[2],r[2]),t[3]=Math.max(a[3],r[3]),t},n.round=function(t,a){return t[0]=Math.round(a[0]),t[1]=Math.round(a[1]),t[2]=Math.round(a[2]),t[3]=Math.round(a[3]),t},n.scale=function(t,a,r){return t[0]=a[0]*r,t[1]=a[1]*r,t[2]=a[2]*r,t[3]=a[3]*r,t},n.scaleAndAdd=function(t,a,r,e){return t[0]=a[0]+r[0]*e,t[1]=a[1]+r[1]*e,t[2]=a[2]+r[2]*e,t[3]=a[3]+r[3]*e,t},n.distance=function(t,a){var r=a[0]-t[0],e=a[1]-t[1],n=a[2]-t[2],o=a[3]-t[3];return Math.sqrt(r*r+e*e+n*n+o*o)},n.dist=n.distance,n.squaredDistance=function(t,a){var r=a[0]-t[0],e=a[1]-t[1],n=a[2]-t[2],o=a[3]-t[3];return r*r+e*e+n*n+o*o},n.sqrDist=n.squaredDistance,n.length=function(t){var a=t[0],r=t[1],e=t[2],n=t[3];return Math.sqrt(a*a+r*r+e*e+n*n)},n.len=n.length,n.squaredLength=function(t){var a=t[0],r=t[1],e=t[2],n=t[3];return a*a+r*r+e*e+n*n},n.sqrLen=n.squaredLength,n.negate=function(t,a){return t[0]=-a[0],t[1]=-a[1],t[2]=-a[2],t[3]=-a[3],t},n.inverse=function(t,a){return t[0]=1/a[0],t[1]=1/a[1],t[2]=1/a[2],t[3]=1/a[3],t},n.normalize=function(t,a){var r=a[0],e=a[1],n=a[2],o=a[3],u=r*r+e*e+n*n+o*o;return u>0&&(u=1/Math.sqrt(u),t[0]=r*u,t[1]=e*u,t[2]=n*u,t[3]=o*u),t},n.dot=function(t,a){return t[0]*a[0]+t[1]*a[1]+t[2]*a[2]+t[3]*a[3]},n.lerp=function(t,a,r,e){var n=a[0],o=a[1],u=a[2],i=a[3];return t[0]=n+e*(r[0]-n),t[1]=o+e*(r[1]-o),t[2]=u+e*(r[2]-u),t[3]=i+e*(r[3]-i),t},n.random=function(t,a){return a=a||1,t[0]=e.RANDOM(),t[1]=e.RANDOM(),t[2]=e.RANDOM(),t[3]=e.RANDOM(),n.normalize(t,t),n.scale(t,t,a),t},n.transformMat4=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=a[3];return t[0]=r[0]*e+r[4]*n+r[8]*o+r[12]*u,t[1]=r[1]*e+r[5]*n+r[9]*o+r[13]*u,t[2]=r[2]*e+r[6]*n+r[10]*o+r[14]*u,t[3]=r[3]*e+r[7]*n+r[11]*o+r[15]*u,t},n.transformQuat=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=r[0],i=r[1],l=r[2],s=r[3],M=s*e+i*o-l*n,f=s*n+l*e-u*o,h=s*o+u*n-i*e,c=-u*e-i*n-l*o;return t[0]=M*s+c*-u+f*-l-h*-i,t[1]=f*s+c*-i+h*-u-M*-l,t[2]=h*s+c*-l+M*-i-f*-u,t[3]=a[3],t},n.forEach=function(){var t=n.create();return function(a,r,e,n,o,u){var i,l;for(r||(r=4),e||(e=0),l=n?Math.min(n*r+e,a.length):a.length,i=e;i<l;i+=r)t[0]=a[i],t[1]=a[i+1],t[2]=a[i+2],t[3]=a[i+3],o(t,t,u),a[i]=t[0],a[i+1]=t[1],a[i+2]=t[2],a[i+3]=t[3];return a}}(),n.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},n.exactEquals=function(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]},n.equals=function(t,a){var r=t[0],n=t[1],o=t[2],u=t[3],i=a[0],l=a[1],s=a[2],M=a[3];return Math.abs(r-i)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-l)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(o-s)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(u-M)<=e.EPSILON*Math.max(1,Math.abs(u),Math.abs(M))},t.exports=n},function(t,a,r){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function n(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var o=function(){function t(t,a){for(var r=0;r<a.length;r++){var e=a[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(a,r,e){return r&&t(a.prototype,r),e&&t(a,e),a}}(),u=r(2),i=e(u),l=r(3),s=(e(l),r(4)),M=e(s),f=r(11),h="\n    attribute vec4 a_VertexPosition;\n    uniform mat4 u_ProjectMatrix;\n    uniform mat4 u_ModelViewMatrix;\n    uniform sampler2D u_WaterInfo;\n    varying vec3 v_Position;\n\n    void main() {\n        vec4 info = texture2D(u_WaterInfo, a_VertexPosition.xy * 0.5 + 0.5);\n\n        v_Position = a_VertexPosition.xzy;\n        v_Position.y += info.r;\n\n        gl_Position = u_ProjectMatrix * u_ModelViewMatrix * vec4(v_Position, 1.0);\n    }\n",c="\n    precision highp float;\n    uniform vec3 u_LightPosition;\n    uniform vec3 u_LightColor;\n    uniform vec3 u_WaterColor;\n    uniform sampler2D u_WaterInfo;\n    varying vec3 v_Position;\n\n    void main() {\n        vec2 coord = v_Position.xz * 0.5 + 0.5;\n        vec4 info = texture2D(u_WaterInfo, coord);\n\n        for (int i = 0; i < 5; i++) {\n            coord += info.ba * 0.005;\n            info = texture2D(u_WaterInfo, coord);\n        }\n\n        vec3 normal = vec3(info.b, sqrt(1.0 - dot(info.ba, info.ba)), info.a);\n        vec3 direction = normalize(u_LightPosition - v_Position);\n        vec3 diffuse = u_LightColor * u_WaterColor * max(dot(direction, normal), 0.0);\n\n        gl_FragColor = vec4(info.r * 1000.0, diffuse.gb, 1.0);\n    }\n",x=256,S=256,d=function(){function t(a){n(this,t),this.gl=a;for(var r=[],e=[],o=0;o<=S;o++)for(var u=o/S,l=0;l<=x;l++){var s=l/x;if(r.push(-1+2*s,-1+2*u),l<x&&o<S){var d=l+o*(x+1);e.push(d,d+1,d+x+1),e.push(d+1,d+x+2,d+x+1)}}this.bufferVertex=new i.default(a,a.ARRAY_BUFFER),this.bufferVertex.write(new Float32Array(r),2),this.bufferIndex=new i.default(a,a.ELEMENT_ARRAY_BUFFER),this.bufferIndex.write(new Uint16Array(e)),this.projectMatrix=f.mat4.create(),f.mat4.perspective(this.projectMatrix,45,1,.1,1e3),this.modelViewMatrix=f.mat4.create(),f.mat4.lookAt(this.modelViewMatrix,f.vec3.fromValues(.8,.2,0),f.vec3.fromValues(0,0,0),f.vec3.fromValues(-1,1,0)),this.lightPosition=f.vec3.fromValues(-3,10,3),this.lightColor=f.vec3.fromValues(1,1,1),this.waterColor=f.vec3.fromValues(.25,1,1.25),this.programWater=new M.default(a),this.programWater.attach(h,a.VERTEX_SHADER),this.programWater.attach(c,a.FRAGMENT_SHADER),this.programWater.link()}return o(t,[{key:"render",value:function(t){var a=this.bufferVertex,r=this.bufferIndex,e=this.projectMatrix,n=this.modelViewMatrix,o=this.lightPosition,u=this.lightColor,i=this.waterColor,l=this.programWater;l.bind(),l.uniform({u_ProjectMatrix:e,u_ModelViewMatrix:n,u_LightPosition:o,u_LightColor:u,u_WaterColor:i,u_WaterInfo:t.textureA}),l.attrib({a_VertexPosition:a}),l.draw(r)}}]),t}();a.default=d},function(t,a,r){"use strict";function e(t){if(t&&t.__esModule)return t;var a={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(a[r]=t[r]);return a.default=t,a}function n(t){return t&&t.__esModule?t:{default:t}}function o(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(a,"__esModule",{value:!0});var u=function(){function t(t,a){for(var r=0;r<a.length;r++){var e=a[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(a,r,e){return r&&t(a.prototype,r),e&&t(a,e),a}}(),i=r(2),l=n(i),s=r(3),M=n(s),f=r(4),h=n(f),c=r(5),x=e(c),S="\n    attribute vec4 a_VertexPosition;\n    varying vec2 v_TextureCoord;\n\n    void main() {\n        v_TextureCoord = a_VertexPosition.xy * 0.5 + 0.5;\n        gl_Position = a_VertexPosition;\n    }\n",d="\n    precision highp float;\n    const float PI = 3.141592653589793;\n    uniform sampler2D u_Texture;\n    uniform vec2 u_Center;\n    uniform float u_Radius;\n    uniform float u_Strength;\n    varying vec2 v_TextureCoord;\n\n    void main() {\n        vec4 info = texture2D(u_Texture, v_TextureCoord);\n\n        // 点距离圆形边缘的比例，1.0（圆心）～0.0（边缘）\n        // 圆形外的忽略\n        float drop = max(0.0, 1.0 - length(u_Center * 0.5 + 0.5 - v_TextureCoord) / u_Radius);\n        // 按照比例，计算出高度值\n        // 此处利用正弦波模拟\n        float ypos = 0.5 - cos(drop * PI) * 0.5;\n        \n        // 利用纹理的r通道记录，记录水体高度\n        info.r += ypos * u_Strength;\n\n        gl_FragColor = info;\n    }\n",m="\n    precision highp float;\n    uniform sampler2D u_Texture;\n    uniform vec2 u_Delta;\n    varying vec2 v_TextureCoord;\n\n    void main() {\n        vec4 info = texture2D(u_Texture, v_TextureCoord);\n\n        vec2 dx = vec2(u_Delta.x, 0.0);\n        vec2 dy = vec2(0.0, u_Delta.y);\n    \n        // 计算出当前坐标最近的四个点，水体高度的平均值\n        float average = (\n            texture2D(u_Texture, v_TextureCoord - dx).r +\n            texture2D(u_Texture, v_TextureCoord - dy).r +\n            texture2D(u_Texture, v_TextureCoord + dx).r +\n            texture2D(u_Texture, v_TextureCoord + dy).r\n        ) * 0.25;\n        \n        // 利用平均值和当前坐标的水体高度，计算出水体高度变化的速度\n        // 纹理的g通道用于记录水体高度变化的速度\n        info.g += (average - info.r) * 2.0;\n        // 乘以0.995是为了模拟阻力\n        info.g *= 0.995;\n    \n        // 把水体高度变化的速度叠加到水体高度上\n        info.r += info.g;\n\n        gl_FragColor = info;\n    }\n",I="\n    precision highp float;\n    uniform sampler2D u_Texture;\n    uniform vec2 u_Delta;\n    varying vec2 v_TextureCoord;\n\n    void main() {\n        vec4 info = texture2D(u_Texture, v_TextureCoord);\n        \n        // 这里计算出当前坐标对水体高度的偏微分\n        vec3 dx = vec3(u_Delta.x, 0.0, texture2D(u_Texture, vec2(v_TextureCoord.x + u_Delta.x, v_TextureCoord.y)).r - info.r);\n        vec3 dy = vec3(0.0, u_Delta.y, texture2D(u_Texture, vec2(v_TextureCoord.x, v_TextureCoord.y + u_Delta.y)).r - info.r);\n        \n        // 对dx，dy进行矢量差乘，计算出法向量\n        // 并利用纹理的ba通道来记录法向量的x轴和y轴\n        info.ba = normalize(cross(dx, dy)).xy;\n\n        gl_FragColor = info;\n    }\n",D=256,F=256,v=function(){function t(a){if(o(this,t),this.gl=a,this.bufferVertex=new l.default(a,a.ARRAY_BUFFER),this.bufferVertex.write(new Float32Array([-1,1,1,1,-1,-1,1,-1]),2),this.bufferIndex=new l.default(a,a.ELEMENT_ARRAY_BUFFER),this.bufferIndex.write(new Uint16Array([0,1,2,1,3,2]),2),x.canUseFloatingPointTexture(a)){var r=x.canUseFloatingPointLinearFiltering(a)?a.LINEAR:a.NEAREST;this.textureA=new M.default(a,a.TEXTURE_2D,{filter:r,width:D,height:F,dataType:a.FLOAT}),this.textureB=new M.default(a,a.TEXTURE_2D,{filter:r,width:D,height:F,dataType:a.FLOAT})}else{if(!x.canUseHalfFloatingPointTexture(a))throw Error("Floating point texture is required");var e=x.canUseHalfFloatingPointLinearFiltering(a)?a.LINEAR:a.NEAREST;this.textureA=new M.default(a,a.TEXTURE_2D,{
filter:e,width:D,height:F,dataType:a.HALF_FLOAT_OES}),this.textureB=new M.default(a,a.TEXTURE_2D,{filter:e,width:D,height:F,dataType:a.HALF_FLOAT_OES})}this.programDrop=new h.default(a),this.programDrop.attach(S,a.VERTEX_SHADER),this.programDrop.attach(d,a.FRAGMENT_SHADER),this.programDrop.link(),this.programStep=new h.default(a),this.programStep.attach(S,a.VERTEX_SHADER),this.programStep.attach(m,a.FRAGMENT_SHADER),this.programStep.link(),this.programNormal=new h.default(a),this.programNormal.attach(S,a.VERTEX_SHADER),this.programNormal.attach(I,a.FRAGMENT_SHADER),this.programNormal.link()}return u(t,[{key:"addDrop",value:function(t,a,r,e){var n=this.textureA,o=this.textureB,u=this.bufferVertex,i=this.bufferIndex,l=this.programDrop;o.write(function(){l.bind(),l.uniform({u_Center:new Float32Array([t,a]),u_Radius:r,u_Strength:e,u_Texture:n}),l.attrib({a_VertexPosition:u}),l.draw(i)}),this.textureA=o,this.textureB=n}},{key:"updateStep",value:function(){var t=this.textureA,a=this.textureB,r=this.bufferVertex,e=this.bufferIndex,n=this.programStep;a.write(function(){n.bind(),n.uniform({u_Delta:new Float32Array([1/D,1/F]),u_Texture:t}),n.attrib({a_VertexPosition:r}),n.draw(e)}),this.textureA=a,this.textureB=t}},{key:"updateNorm",value:function(){var t=this.textureA,a=this.textureB,r=this.bufferVertex,e=this.bufferIndex,n=this.programNormal;a.write(function(){n.bind(),n.uniform({u_Delta:new Float32Array([1/D,1/F]),u_Texture:t}),n.attrib({a_VertexPosition:r}),n.draw(e)}),this.textureA=a,this.textureB=t}}]),t}();a.default=v},function(t,a,r){a.glMatrix=r(1),a.mat2=r(12),a.mat2d=r(13),a.mat3=r(6),a.mat4=r(14),a.quat=r(15),a.vec2=r(16),a.vec3=r(7),a.vec4=r(8)},function(t,a,r){var e=r(1),n={};n.create=function(){var t=new e.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},n.clone=function(t){var a=new e.ARRAY_TYPE(4);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a},n.copy=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t},n.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},n.fromValues=function(t,a,r,n){var o=new e.ARRAY_TYPE(4);return o[0]=t,o[1]=a,o[2]=r,o[3]=n,o},n.set=function(t,a,r,e,n){return t[0]=a,t[1]=r,t[2]=e,t[3]=n,t},n.transpose=function(t,a){if(t===a){var r=a[1];t[1]=a[2],t[2]=r}else t[0]=a[0],t[1]=a[2],t[2]=a[1],t[3]=a[3];return t},n.invert=function(t,a){var r=a[0],e=a[1],n=a[2],o=a[3],u=r*o-n*e;return u?(u=1/u,t[0]=o*u,t[1]=-e*u,t[2]=-n*u,t[3]=r*u,t):null},n.adjoint=function(t,a){var r=a[0];return t[0]=a[3],t[1]=-a[1],t[2]=-a[2],t[3]=r,t},n.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},n.multiply=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=a[3],i=r[0],l=r[1],s=r[2],M=r[3];return t[0]=e*i+o*l,t[1]=n*i+u*l,t[2]=e*s+o*M,t[3]=n*s+u*M,t},n.mul=n.multiply,n.rotate=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=a[3],i=Math.sin(r),l=Math.cos(r);return t[0]=e*l+o*i,t[1]=n*l+u*i,t[2]=e*-i+o*l,t[3]=n*-i+u*l,t},n.scale=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=a[3],i=r[0],l=r[1];return t[0]=e*i,t[1]=n*i,t[2]=o*l,t[3]=u*l,t},n.fromRotation=function(t,a){var r=Math.sin(a),e=Math.cos(a);return t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t},n.fromScaling=function(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=a[1],t},n.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},n.LDU=function(t,a,r,e){return t[2]=e[2]/e[0],r[0]=e[0],r[1]=e[1],r[3]=e[3]-t[2]*r[1],[t,a,r]},n.add=function(t,a,r){return t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t[3]=a[3]+r[3],t},n.subtract=function(t,a,r){return t[0]=a[0]-r[0],t[1]=a[1]-r[1],t[2]=a[2]-r[2],t[3]=a[3]-r[3],t},n.sub=n.subtract,n.exactEquals=function(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]},n.equals=function(t,a){var r=t[0],n=t[1],o=t[2],u=t[3],i=a[0],l=a[1],s=a[2],M=a[3];return Math.abs(r-i)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-l)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(o-s)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(u-M)<=e.EPSILON*Math.max(1,Math.abs(u),Math.abs(M))},n.multiplyScalar=function(t,a,r){return t[0]=a[0]*r,t[1]=a[1]*r,t[2]=a[2]*r,t[3]=a[3]*r,t},n.multiplyScalarAndAdd=function(t,a,r,e){return t[0]=a[0]+r[0]*e,t[1]=a[1]+r[1]*e,t[2]=a[2]+r[2]*e,t[3]=a[3]+r[3]*e,t},t.exports=n},function(t,a,r){var e=r(1),n={};n.create=function(){var t=new e.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},n.clone=function(t){var a=new e.ARRAY_TYPE(6);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a},n.copy=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t},n.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},n.fromValues=function(t,a,r,n,o,u){var i=new e.ARRAY_TYPE(6);return i[0]=t,i[1]=a,i[2]=r,i[3]=n,i[4]=o,i[5]=u,i},n.set=function(t,a,r,e,n,o,u){return t[0]=a,t[1]=r,t[2]=e,t[3]=n,t[4]=o,t[5]=u,t},n.invert=function(t,a){var r=a[0],e=a[1],n=a[2],o=a[3],u=a[4],i=a[5],l=r*o-e*n;return l?(l=1/l,t[0]=o*l,t[1]=-e*l,t[2]=-n*l,t[3]=r*l,t[4]=(n*i-o*u)*l,t[5]=(e*u-r*i)*l,t):null},n.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},n.multiply=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=a[3],i=a[4],l=a[5],s=r[0],M=r[1],f=r[2],h=r[3],c=r[4],x=r[5];return t[0]=e*s+o*M,t[1]=n*s+u*M,t[2]=e*f+o*h,t[3]=n*f+u*h,t[4]=e*c+o*x+i,t[5]=n*c+u*x+l,t},n.mul=n.multiply,n.rotate=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=a[3],i=a[4],l=a[5],s=Math.sin(r),M=Math.cos(r);return t[0]=e*M+o*s,t[1]=n*M+u*s,t[2]=e*-s+o*M,t[3]=n*-s+u*M,t[4]=i,t[5]=l,t},n.scale=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=a[3],i=a[4],l=a[5],s=r[0],M=r[1];return t[0]=e*s,t[1]=n*s,t[2]=o*M,t[3]=u*M,t[4]=i,t[5]=l,t},n.translate=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=a[3],i=a[4],l=a[5],s=r[0],M=r[1];return t[0]=e,t[1]=n,t[2]=o,t[3]=u,t[4]=e*s+o*M+i,t[5]=n*s+u*M+l,t},n.fromRotation=function(t,a){var r=Math.sin(a),e=Math.cos(a);return t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t[4]=0,t[5]=0,t},n.fromScaling=function(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=a[1],t[4]=0,t[5]=0,t},n.fromTranslation=function(t,a){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=a[0],t[5]=a[1],t},n.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},n.add=function(t,a,r){return t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t[3]=a[3]+r[3],t[4]=a[4]+r[4],t[5]=a[5]+r[5],t},n.subtract=function(t,a,r){return t[0]=a[0]-r[0],t[1]=a[1]-r[1],t[2]=a[2]-r[2],t[3]=a[3]-r[3],t[4]=a[4]-r[4],t[5]=a[5]-r[5],t},n.sub=n.subtract,n.multiplyScalar=function(t,a,r){return t[0]=a[0]*r,t[1]=a[1]*r,t[2]=a[2]*r,t[3]=a[3]*r,t[4]=a[4]*r,t[5]=a[5]*r,t},n.multiplyScalarAndAdd=function(t,a,r,e){return t[0]=a[0]+r[0]*e,t[1]=a[1]+r[1]*e,t[2]=a[2]+r[2]*e,t[3]=a[3]+r[3]*e,t[4]=a[4]+r[4]*e,t[5]=a[5]+r[5]*e,t},n.exactEquals=function(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]},n.equals=function(t,a){var r=t[0],n=t[1],o=t[2],u=t[3],i=t[4],l=t[5],s=a[0],M=a[1],f=a[2],h=a[3],c=a[4],x=a[5];return Math.abs(r-s)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-M)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(o-f)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(f))&&Math.abs(u-h)<=e.EPSILON*Math.max(1,Math.abs(u),Math.abs(h))&&Math.abs(i-c)<=e.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(l-x)<=e.EPSILON*Math.max(1,Math.abs(l),Math.abs(x))},t.exports=n},function(t,a,r){var e=r(1),n={scalar:{},SIMD:{}};n.create=function(){var t=new e.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.clone=function(t){var a=new e.ARRAY_TYPE(16);return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a},n.copy=function(t,a){return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},n.fromValues=function(t,a,r,n,o,u,i,l,s,M,f,h,c,x,S,d){var m=new e.ARRAY_TYPE(16);return m[0]=t,m[1]=a,m[2]=r,m[3]=n,m[4]=o,m[5]=u,m[6]=i,m[7]=l,m[8]=s,m[9]=M,m[10]=f,m[11]=h,m[12]=c,m[13]=x,m[14]=S,m[15]=d,m},n.set=function(t,a,r,e,n,o,u,i,l,s,M,f,h,c,x,S,d){return t[0]=a,t[1]=r,t[2]=e,t[3]=n,t[4]=o,t[5]=u,t[6]=i,t[7]=l,t[8]=s,t[9]=M,t[10]=f,t[11]=h,t[12]=c,t[13]=x,t[14]=S,t[15]=d,t},n.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.scalar.transpose=function(t,a){if(t===a){var r=a[1],e=a[2],n=a[3],o=a[6],u=a[7],i=a[11];t[1]=a[4],t[2]=a[8],t[3]=a[12],t[4]=r,t[6]=a[9],t[7]=a[13],t[8]=e,t[9]=o,t[11]=a[14],t[12]=n,t[13]=u,t[14]=i}else t[0]=a[0],t[1]=a[4],t[2]=a[8],t[3]=a[12],t[4]=a[1],t[5]=a[5],t[6]=a[9],t[7]=a[13],t[8]=a[2],t[9]=a[6],t[10]=a[10],t[11]=a[14],t[12]=a[3],t[13]=a[7],t[14]=a[11],t[15]=a[15];return t},n.SIMD.transpose=function(t,a){var r,e,n,o,u,i,l,s,M,f;return r=SIMD.Float32x4.load(a,0),e=SIMD.Float32x4.load(a,4),n=SIMD.Float32x4.load(a,8),o=SIMD.Float32x4.load(a,12),u=SIMD.Float32x4.shuffle(r,e,0,1,4,5),i=SIMD.Float32x4.shuffle(n,o,0,1,4,5),l=SIMD.Float32x4.shuffle(u,i,0,2,4,6),s=SIMD.Float32x4.shuffle(u,i,1,3,5,7),SIMD.Float32x4.store(t,0,l),SIMD.Float32x4.store(t,4,s),u=SIMD.Float32x4.shuffle(r,e,2,3,6,7),i=SIMD.Float32x4.shuffle(n,o,2,3,6,7),M=SIMD.Float32x4.shuffle(u,i,0,2,4,6),f=SIMD.Float32x4.shuffle(u,i,1,3,5,7),SIMD.Float32x4.store(t,8,M),SIMD.Float32x4.store(t,12,f),t},n.transpose=e.USE_SIMD?n.SIMD.transpose:n.scalar.transpose,n.scalar.invert=function(t,a){var r=a[0],e=a[1],n=a[2],o=a[3],u=a[4],i=a[5],l=a[6],s=a[7],M=a[8],f=a[9],h=a[10],c=a[11],x=a[12],S=a[13],d=a[14],m=a[15],I=r*i-e*u,D=r*l-n*u,F=r*s-o*u,v=e*l-n*i,b=e*s-o*i,_=n*s-o*l,p=M*S-f*x,E=M*d-h*x,g=M*m-c*x,w=f*d-h*S,A=f*m-c*S,T=h*m-c*d,y=I*T-D*A+F*w+v*g-b*E+_*p;return y?(y=1/y,t[0]=(i*T-l*A+s*w)*y,t[1]=(n*A-e*T-o*w)*y,t[2]=(S*_-d*b+m*v)*y,t[3]=(h*b-f*_-c*v)*y,t[4]=(l*g-u*T-s*E)*y,t[5]=(r*T-n*g+o*E)*y,t[6]=(d*F-x*_-m*D)*y,t[7]=(M*_-h*F+c*D)*y,t[8]=(u*A-i*g+s*p)*y,t[9]=(e*g-r*A-o*p)*y,t[10]=(x*b-S*F+m*I)*y,t[11]=(f*F-M*b-c*I)*y,t[12]=(i*E-u*w-l*p)*y,t[13]=(r*w-e*E+n*p)*y,t[14]=(S*D-x*v-d*I)*y,t[15]=(M*v-f*D+h*I)*y,t):null},n.SIMD.invert=function(t,a){var r,e,n,o,u,i,l,s,M,f,h=SIMD.Float32x4.load(a,0),c=SIMD.Float32x4.load(a,4),x=SIMD.Float32x4.load(a,8),S=SIMD.Float32x4.load(a,12);return u=SIMD.Float32x4.shuffle(h,c,0,1,4,5),e=SIMD.Float32x4.shuffle(x,S,0,1,4,5),r=SIMD.Float32x4.shuffle(u,e,0,2,4,6),e=SIMD.Float32x4.shuffle(e,u,1,3,5,7),u=SIMD.Float32x4.shuffle(h,c,2,3,6,7),o=SIMD.Float32x4.shuffle(x,S,2,3,6,7),n=SIMD.Float32x4.shuffle(u,o,0,2,4,6),o=SIMD.Float32x4.shuffle(o,u,1,3,5,7),u=SIMD.Float32x4.mul(n,o),u=SIMD.Float32x4.swizzle(u,1,0,3,2),i=SIMD.Float32x4.mul(e,u),l=SIMD.Float32x4.mul(r,u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),i=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,u),i),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,u),l),l=SIMD.Float32x4.swizzle(l,2,3,0,1),u=SIMD.Float32x4.mul(e,n),u=SIMD.Float32x4.swizzle(u,1,0,3,2),i=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,u),i),M=SIMD.Float32x4.mul(r,u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),i=SIMD.Float32x4.sub(i,SIMD.Float32x4.mul(o,u)),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,u),M),M=SIMD.Float32x4.swizzle(M,2,3,0,1),u=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(e,2,3,0,1),o),u=SIMD.Float32x4.swizzle(u,1,0,3,2),n=SIMD.Float32x4.swizzle(n,2,3,0,1),i=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,u),i),s=SIMD.Float32x4.mul(r,u),u=SIMD.Float32x4.swizzle(u,2,3,0,1),i=SIMD.Float32x4.sub(i,SIMD.Float32x4.mul(n,u)),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(r,u),s),s=SIMD.Float32x4.swizzle(s,2,3,0,1),u=SIMD.Float32x4.mul(r,e),u=SIMD.Float32x4.swizzle(u,1,0,3,2),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,u),s),M=SIMD.Float32x4.sub(SIMD.Float32x4.mul(n,u),M),u=SIMD.Float32x4.swizzle(u,2,3,0,1),s=SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,u),s),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(n,u)),u=SIMD.Float32x4.mul(r,o),u=SIMD.Float32x4.swizzle(u,1,0,3,2),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(n,u)),s=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,u),s),u=SIMD.Float32x4.swizzle(u,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(n,u),l),s=SIMD.Float32x4.sub(s,SIMD.Float32x4.mul(e,u)),u=SIMD.Float32x4.mul(r,n),u=SIMD.Float32x4.swizzle(u,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(o,u),l),M=SIMD.Float32x4.sub(M,SIMD.Float32x4.mul(e,u)),u=SIMD.Float32x4.swizzle(u,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(o,u)),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,u),M),f=SIMD.Float32x4.mul(r,i),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,2,3,0,1),f),f=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(f,1,0,3,2),f),u=SIMD.Float32x4.reciprocalApproximation(f),f=SIMD.Float32x4.sub(SIMD.Float32x4.add(u,u),SIMD.Float32x4.mul(f,SIMD.Float32x4.mul(u,u))),(f=SIMD.Float32x4.swizzle(f,0,0,0,0))?(SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(f,i)),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(f,l)),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(f,s)),SIMD.Float32x4.store(t,12,SIMD.Float32x4.mul(f,M)),t):null},n.invert=e.USE_SIMD?n.SIMD.invert:n.scalar.invert,n.scalar.adjoint=function(t,a){var r=a[0],e=a[1],n=a[2],o=a[3],u=a[4],i=a[5],l=a[6],s=a[7],M=a[8],f=a[9],h=a[10],c=a[11],x=a[12],S=a[13],d=a[14],m=a[15];return t[0]=i*(h*m-c*d)-f*(l*m-s*d)+S*(l*c-s*h),t[1]=-(e*(h*m-c*d)-f*(n*m-o*d)+S*(n*c-o*h)),t[2]=e*(l*m-s*d)-i*(n*m-o*d)+S*(n*s-o*l),t[3]=-(e*(l*c-s*h)-i*(n*c-o*h)+f*(n*s-o*l)),t[4]=-(u*(h*m-c*d)-M*(l*m-s*d)+x*(l*c-s*h)),t[5]=r*(h*m-c*d)-M*(n*m-o*d)+x*(n*c-o*h),t[6]=-(r*(l*m-s*d)-u*(n*m-o*d)+x*(n*s-o*l)),t[7]=r*(l*c-s*h)-u*(n*c-o*h)+M*(n*s-o*l),t[8]=u*(f*m-c*S)-M*(i*m-s*S)+x*(i*c-s*f),t[9]=-(r*(f*m-c*S)-M*(e*m-o*S)+x*(e*c-o*f)),t[10]=r*(i*m-s*S)-u*(e*m-o*S)+x*(e*s-o*i),t[11]=-(r*(i*c-s*f)-u*(e*c-o*f)+M*(e*s-o*i)),t[12]=-(u*(f*d-h*S)-M*(i*d-l*S)+x*(i*h-l*f)),t[13]=r*(f*d-h*S)-M*(e*d-n*S)+x*(e*h-n*f),t[14]=-(r*(i*d-l*S)-u*(e*d-n*S)+x*(e*l-n*i)),t[15]=r*(i*h-l*f)-u*(e*h-n*f)+M*(e*l-n*i),t},n.SIMD.adjoint=function(t,a){var r,e,n,o,u,i,l,s,M,f,h,c,x,r=SIMD.Float32x4.load(a,0),e=SIMD.Float32x4.load(a,4),n=SIMD.Float32x4.load(a,8),o=SIMD.Float32x4.load(a,12);return M=SIMD.Float32x4.shuffle(r,e,0,1,4,5),i=SIMD.Float32x4.shuffle(n,o,0,1,4,5),u=SIMD.Float32x4.shuffle(M,i,0,2,4,6),i=SIMD.Float32x4.shuffle(i,M,1,3,5,7),M=SIMD.Float32x4.shuffle(r,e,2,3,6,7),s=SIMD.Float32x4.shuffle(n,o,2,3,6,7),l=SIMD.Float32x4.shuffle(M,s,0,2,4,6),s=SIMD.Float32x4.shuffle(s,M,1,3,5,7),M=SIMD.Float32x4.mul(l,s),M=SIMD.Float32x4.swizzle(M,1,0,3,2),f=SIMD.Float32x4.mul(i,M),h=SIMD.Float32x4.mul(u,M),M=SIMD.Float32x4.swizzle(M,2,3,0,1),f=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,M),f),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,M),h),h=SIMD.Float32x4.swizzle(h,2,3,0,1),M=SIMD.Float32x4.mul(i,l),M=SIMD.Float32x4.swizzle(M,1,0,3,2),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,M),f),x=SIMD.Float32x4.mul(u,M),M=SIMD.Float32x4.swizzle(M,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(s,M)),x=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,M),x),x=SIMD.Float32x4.swizzle(x,2,3,0,1),M=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(i,2,3,0,1),s),M=SIMD.Float32x4.swizzle(M,1,0,3,2),l=SIMD.Float32x4.swizzle(l,2,3,0,1),f=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,M),f),c=SIMD.Float32x4.mul(u,M),M=SIMD.Float32x4.swizzle(M,2,3,0,1),f=SIMD.Float32x4.sub(f,SIMD.Float32x4.mul(l,M)),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,M),c),c=SIMD.Float32x4.swizzle(c,2,3,0,1),M=SIMD.Float32x4.mul(u,i),M=SIMD.Float32x4.swizzle(M,1,0,3,2),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,M),c),x=SIMD.Float32x4.sub(SIMD.Float32x4.mul(l,M),x),M=SIMD.Float32x4.swizzle(M,2,3,0,1),c=SIMD.Float32x4.sub(SIMD.Float32x4.mul(s,M),c),x=SIMD.Float32x4.sub(x,SIMD.Float32x4.mul(l,M)),M=SIMD.Float32x4.mul(u,s),M=SIMD.Float32x4.swizzle(M,1,0,3,2),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(l,M)),c=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,M),c),M=SIMD.Float32x4.swizzle(M,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(l,M),h),c=SIMD.Float32x4.sub(c,SIMD.Float32x4.mul(i,M)),M=SIMD.Float32x4.mul(u,l),M=SIMD.Float32x4.swizzle(M,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(s,M),h),x=SIMD.Float32x4.sub(x,SIMD.Float32x4.mul(i,M)),M=SIMD.Float32x4.swizzle(M,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(s,M)),x=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,M),x),SIMD.Float32x4.store(t,0,f),SIMD.Float32x4.store(t,4,h),SIMD.Float32x4.store(t,8,c),SIMD.Float32x4.store(t,12,x),t},n.adjoint=e.USE_SIMD?n.SIMD.adjoint:n.scalar.adjoint,n.determinant=function(t){var a=t[0],r=t[1],e=t[2],n=t[3],o=t[4],u=t[5],i=t[6],l=t[7],s=t[8],M=t[9],f=t[10],h=t[11],c=t[12],x=t[13],S=t[14],d=t[15],m=a*u-r*o,I=a*i-e*o,D=a*l-n*o,F=r*i-e*u,v=r*l-n*u,b=e*l-n*i,_=s*x-M*c,p=s*S-f*c,E=s*d-h*c,g=M*S-f*x,w=M*d-h*x,A=f*d-h*S;return m*A-I*w+D*g+F*E-v*p+b*_},n.SIMD.multiply=function(t,a,r){var e=SIMD.Float32x4.load(a,0),n=SIMD.Float32x4.load(a,4),o=SIMD.Float32x4.load(a,8),u=SIMD.Float32x4.load(a,12),i=SIMD.Float32x4.load(r,0),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(i,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(i,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(i,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(i,3,3,3,3),u))));SIMD.Float32x4.store(t,0,l);var s=SIMD.Float32x4.load(r,4),M=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(s,3,3,3,3),u))));SIMD.Float32x4.store(t,4,M);var f=SIMD.Float32x4.load(r,8),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(f,3,3,3,3),u))));SIMD.Float32x4.store(t,8,h);var c=SIMD.Float32x4.load(r,12),x=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),n),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),o),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),u))));return SIMD.Float32x4.store(t,12,x),t},n.scalar.multiply=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=a[3],i=a[4],l=a[5],s=a[6],M=a[7],f=a[8],h=a[9],c=a[10],x=a[11],S=a[12],d=a[13],m=a[14],I=a[15],D=r[0],F=r[1],v=r[2],b=r[3];return t[0]=D*e+F*i+v*f+b*S,t[1]=D*n+F*l+v*h+b*d,t[2]=D*o+F*s+v*c+b*m,t[3]=D*u+F*M+v*x+b*I,D=r[4],F=r[5],v=r[6],b=r[7],t[4]=D*e+F*i+v*f+b*S,t[5]=D*n+F*l+v*h+b*d,t[6]=D*o+F*s+v*c+b*m,t[7]=D*u+F*M+v*x+b*I,D=r[8],F=r[9],v=r[10],b=r[11],t[8]=D*e+F*i+v*f+b*S,t[9]=D*n+F*l+v*h+b*d,t[10]=D*o+F*s+v*c+b*m,t[11]=D*u+F*M+v*x+b*I,D=r[12],F=r[13],v=r[14],b=r[15],t[12]=D*e+F*i+v*f+b*S,t[13]=D*n+F*l+v*h+b*d,t[14]=D*o+F*s+v*c+b*m,t[15]=D*u+F*M+v*x+b*I,t},n.multiply=e.USE_SIMD?n.SIMD.multiply:n.scalar.multiply,n.mul=n.multiply,n.scalar.translate=function(t,a,r){var e,n,o,u,i,l,s,M,f,h,c,x,S=r[0],d=r[1],m=r[2];return a===t?(t[12]=a[0]*S+a[4]*d+a[8]*m+a[12],t[13]=a[1]*S+a[5]*d+a[9]*m+a[13],t[14]=a[2]*S+a[6]*d+a[10]*m+a[14],t[15]=a[3]*S+a[7]*d+a[11]*m+a[15]):(e=a[0],n=a[1],o=a[2],u=a[3],i=a[4],l=a[5],s=a[6],M=a[7],f=a[8],h=a[9],c=a[10],x=a[11],t[0]=e,t[1]=n,t[2]=o,t[3]=u,t[4]=i,t[5]=l,t[6]=s,t[7]=M,t[8]=f,t[9]=h,t[10]=c,t[11]=x,t[12]=e*S+i*d+f*m+a[12],t[13]=n*S+l*d+h*m+a[13],t[14]=o*S+s*d+c*m+a[14],t[15]=u*S+M*d+x*m+a[15]),t},n.SIMD.translate=function(t,a,r){var e=SIMD.Float32x4.load(a,0),n=SIMD.Float32x4.load(a,4),o=SIMD.Float32x4.load(a,8),u=SIMD.Float32x4.load(a,12),i=SIMD.Float32x4(r[0],r[1],r[2],0);a!==t&&(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11]),e=SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(i,0,0,0,0)),n=SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(i,1,1,1,1)),o=SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(i,2,2,2,2));var l=SIMD.Float32x4.add(e,SIMD.Float32x4.add(n,SIMD.Float32x4.add(o,u)));return SIMD.Float32x4.store(t,12,l),t},n.translate=e.USE_SIMD?n.SIMD.translate:n.scalar.translate,n.scalar.scale=function(t,a,r){var e=r[0],n=r[1],o=r[2];return t[0]=a[0]*e,t[1]=a[1]*e,t[2]=a[2]*e,t[3]=a[3]*e,t[4]=a[4]*n,t[5]=a[5]*n,t[6]=a[6]*n,t[7]=a[7]*n,t[8]=a[8]*o,t[9]=a[9]*o,t[10]=a[10]*o,t[11]=a[11]*o,t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},n.SIMD.scale=function(t,a,r){var e,n,o,u=SIMD.Float32x4(r[0],r[1],r[2],0);return e=SIMD.Float32x4.load(a,0),SIMD.Float32x4.store(t,0,SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(u,0,0,0,0))),n=SIMD.Float32x4.load(a,4),SIMD.Float32x4.store(t,4,SIMD.Float32x4.mul(n,SIMD.Float32x4.swizzle(u,1,1,1,1))),o=SIMD.Float32x4.load(a,8),SIMD.Float32x4.store(t,8,SIMD.Float32x4.mul(o,SIMD.Float32x4.swizzle(u,2,2,2,2))),t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},n.scale=e.USE_SIMD?n.SIMD.scale:n.scalar.scale,n.rotate=function(t,a,r,n){var o,u,i,l,s,M,f,h,c,x,S,d,m,I,D,F,v,b,_,p,E,g,w,A,T=n[0],y=n[1],R=n[2],P=Math.sqrt(T*T+y*y+R*R);return Math.abs(P)<e.EPSILON?null:(P=1/P,T*=P,y*=P,R*=P,o=Math.sin(r),u=Math.cos(r),i=1-u,l=a[0],s=a[1],M=a[2],f=a[3],h=a[4],c=a[5],x=a[6],S=a[7],d=a[8],m=a[9],I=a[10],D=a[11],F=T*T*i+u,v=y*T*i+R*o,b=R*T*i-y*o,_=T*y*i-R*o,p=y*y*i+u,E=R*y*i+T*o,g=T*R*i+y*o,w=y*R*i-T*o,A=R*R*i+u,t[0]=l*F+h*v+d*b,t[1]=s*F+c*v+m*b,t[2]=M*F+x*v+I*b,t[3]=f*F+S*v+D*b,t[4]=l*_+h*p+d*E,t[5]=s*_+c*p+m*E,t[6]=M*_+x*p+I*E,t[7]=f*_+S*p+D*E,t[8]=l*g+h*w+d*A,t[9]=s*g+c*w+m*A,t[10]=M*g+x*w+I*A,t[11]=f*g+S*w+D*A,a!==t&&(t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t)},n.scalar.rotateX=function(t,a,r){var e=Math.sin(r),n=Math.cos(r),o=a[4],u=a[5],i=a[6],l=a[7],s=a[8],M=a[9],f=a[10],h=a[11];return a!==t&&(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[4]=o*n+s*e,t[5]=u*n+M*e,t[6]=i*n+f*e,t[7]=l*n+h*e,t[8]=s*n-o*e,t[9]=M*n-u*e,t[10]=f*n-i*e,t[11]=h*n-l*e,t},n.SIMD.rotateX=function(t,a,r){var e=SIMD.Float32x4.splat(Math.sin(r)),n=SIMD.Float32x4.splat(Math.cos(r));a!==t&&(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]);var o=SIMD.Float32x4.load(a,4),u=SIMD.Float32x4.load(a,8);return SIMD.Float32x4.store(t,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(u,e))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,n),SIMD.Float32x4.mul(o,e))),t},n.rotateX=e.USE_SIMD?n.SIMD.rotateX:n.scalar.rotateX,n.scalar.rotateY=function(t,a,r){var e=Math.sin(r),n=Math.cos(r),o=a[0],u=a[1],i=a[2],l=a[3],s=a[8],M=a[9],f=a[10],h=a[11];return a!==t&&(t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[0]=o*n-s*e,t[1]=u*n-M*e,t[2]=i*n-f*e,t[3]=l*n-h*e,t[8]=o*e+s*n,t[9]=u*e+M*n,t[10]=i*e+f*n,t[11]=l*e+h*n,t},n.SIMD.rotateY=function(t,a,r){var e=SIMD.Float32x4.splat(Math.sin(r)),n=SIMD.Float32x4.splat(Math.cos(r));a!==t&&(t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]);var o=SIMD.Float32x4.load(a,0),u=SIMD.Float32x4.load(a,8);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(u,e))),SIMD.Float32x4.store(t,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,e),SIMD.Float32x4.mul(u,n))),t},n.rotateY=e.USE_SIMD?n.SIMD.rotateY:n.scalar.rotateY,n.scalar.rotateZ=function(t,a,r){var e=Math.sin(r),n=Math.cos(r),o=a[0],u=a[1],i=a[2],l=a[3],s=a[4],M=a[5],f=a[6],h=a[7];return a!==t&&(t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]),t[0]=o*n+s*e,t[1]=u*n+M*e,t[2]=i*n+f*e,t[3]=l*n+h*e,t[4]=s*n-o*e,t[5]=M*n-u*e,t[6]=f*n-i*e,t[7]=h*n-l*e,t},n.SIMD.rotateZ=function(t,a,r){var e=SIMD.Float32x4.splat(Math.sin(r)),n=SIMD.Float32x4.splat(Math.cos(r));a!==t&&(t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15]);var o=SIMD.Float32x4.load(a,0),u=SIMD.Float32x4.load(a,4);return SIMD.Float32x4.store(t,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(o,n),SIMD.Float32x4.mul(u,e))),SIMD.Float32x4.store(t,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(u,n),SIMD.Float32x4.mul(o,e))),t},n.rotateZ=e.USE_SIMD?n.SIMD.rotateZ:n.scalar.rotateZ,n.fromTranslation=function(t,a){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=a[0],t[13]=a[1],t[14]=a[2],t[15]=1,t},n.fromScaling=function(t,a){return t[0]=a[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=a[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromRotation=function(t,a,r){var n,o,u,i=r[0],l=r[1],s=r[2],M=Math.sqrt(i*i+l*l+s*s);return Math.abs(M)<e.EPSILON?null:(M=1/M,i*=M,l*=M,s*=M,n=Math.sin(a),o=Math.cos(a),u=1-o,t[0]=i*i*u+o,t[1]=l*i*u+s*n,t[2]=s*i*u-l*n,t[3]=0,t[4]=i*l*u-s*n,t[5]=l*l*u+o,t[6]=s*l*u+i*n,t[7]=0,t[8]=i*s*u+l*n,t[9]=l*s*u-i*n,t[10]=s*s*u+o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},n.fromXRotation=function(t,a){var r=Math.sin(a),e=Math.cos(a);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromYRotation=function(t,a){var r=Math.sin(a),e=Math.cos(a);return t[0]=e,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromZRotation=function(t,a){var r=Math.sin(a),e=Math.cos(a);return t[0]=e,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.fromRotationTranslation=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=a[3],i=e+e,l=n+n,s=o+o,M=e*i,f=e*l,h=e*s,c=n*l,x=n*s,S=o*s,d=u*i,m=u*l,I=u*s;return t[0]=1-(c+S),t[1]=f+I,t[2]=h-m,t[3]=0,t[4]=f-I,t[5]=1-(M+S),t[6]=x+d,t[7]=0,t[8]=h+m,t[9]=x-d,t[10]=1-(M+c),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},n.getTranslation=function(t,a){return t[0]=a[12],t[1]=a[13],t[2]=a[14],t},n.getRotation=function(t,a){var r=a[0]+a[5]+a[10],e=0;return r>0?(e=2*Math.sqrt(r+1),t[3]=.25*e,t[0]=(a[6]-a[9])/e,t[1]=(a[8]-a[2])/e,t[2]=(a[1]-a[4])/e):a[0]>a[5]&a[0]>a[10]?(e=2*Math.sqrt(1+a[0]-a[5]-a[10]),t[3]=(a[6]-a[9])/e,t[0]=.25*e,t[1]=(a[1]+a[4])/e,t[2]=(a[8]+a[2])/e):a[5]>a[10]?(e=2*Math.sqrt(1+a[5]-a[0]-a[10]),t[3]=(a[8]-a[2])/e,t[0]=(a[1]+a[4])/e,t[1]=.25*e,t[2]=(a[6]+a[9])/e):(e=2*Math.sqrt(1+a[10]-a[0]-a[5]),t[3]=(a[1]-a[4])/e,t[0]=(a[8]+a[2])/e,t[1]=(a[6]+a[9])/e,t[2]=.25*e),t},n.fromRotationTranslationScale=function(t,a,r,e){var n=a[0],o=a[1],u=a[2],i=a[3],l=n+n,s=o+o,M=u+u,f=n*l,h=n*s,c=n*M,x=o*s,S=o*M,d=u*M,m=i*l,I=i*s,D=i*M,F=e[0],v=e[1],b=e[2];return t[0]=(1-(x+d))*F,t[1]=(h+D)*F,t[2]=(c-I)*F,t[3]=0,t[4]=(h-D)*v,t[5]=(1-(f+d))*v,t[6]=(S+m)*v,t[7]=0,t[8]=(c+I)*b,t[9]=(S-m)*b,t[10]=(1-(f+x))*b,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},n.fromRotationTranslationScaleOrigin=function(t,a,r,e,n){var o=a[0],u=a[1],i=a[2],l=a[3],s=o+o,M=u+u,f=i+i,h=o*s,c=o*M,x=o*f,S=u*M,d=u*f,m=i*f,I=l*s,D=l*M,F=l*f,v=e[0],b=e[1],_=e[2],p=n[0],E=n[1],g=n[2];return t[0]=(1-(S+m))*v,t[1]=(c+F)*v,t[2]=(x-D)*v,t[3]=0,t[4]=(c-F)*b,t[5]=(1-(h+m))*b,t[6]=(d+I)*b,t[7]=0,t[8]=(x+D)*_,t[9]=(d-I)*_,t[10]=(1-(h+S))*_,t[11]=0,t[12]=r[0]+p-(t[0]*p+t[4]*E+t[8]*g),t[13]=r[1]+E-(t[1]*p+t[5]*E+t[9]*g),t[14]=r[2]+g-(t[2]*p+t[6]*E+t[10]*g),t[15]=1,t},n.fromQuat=function(t,a){var r=a[0],e=a[1],n=a[2],o=a[3],u=r+r,i=e+e,l=n+n,s=r*u,M=e*u,f=e*i,h=n*u,c=n*i,x=n*l,S=o*u,d=o*i,m=o*l;return t[0]=1-f-x,t[1]=M+m,t[2]=h-d,t[3]=0,t[4]=M-m,t[5]=1-s-x,t[6]=c+S,t[7]=0,t[8]=h+d,t[9]=c-S,t[10]=1-s-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},n.frustum=function(t,a,r,e,n,o,u){var i=1/(r-a),l=1/(n-e),s=1/(o-u);return t[0]=2*o*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(r+a)*i,t[9]=(n+e)*l,t[10]=(u+o)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=u*o*2*s,t[15]=0,t},n.perspective=function(t,a,r,e,n){var o=1/Math.tan(a/2),u=1/(e-n);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(n+e)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*n*e*u,t[15]=0,t},n.perspectiveFromFieldOfView=function(t,a,r,e){var n=Math.tan(a.upDegrees*Math.PI/180),o=Math.tan(a.downDegrees*Math.PI/180),u=Math.tan(a.leftDegrees*Math.PI/180),i=Math.tan(a.rightDegrees*Math.PI/180),l=2/(u+i),s=2/(n+o);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=-((u-i)*l*.5),t[9]=(n-o)*s*.5,t[10]=e/(r-e),t[11]=-1,t[12]=0,t[13]=0,t[14]=e*r/(r-e),t[15]=0,t},n.ortho=function(t,a,r,e,n,o,u){var i=1/(a-r),l=1/(e-n),s=1/(o-u);return t[0]=-2*i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*s,t[11]=0,t[12]=(a+r)*i,t[13]=(n+e)*l,t[14]=(u+o)*s,t[15]=1,t},n.lookAt=function(t,a,r,o){var u,i,l,s,M,f,h,c,x,S,d=a[0],m=a[1],I=a[2],D=o[0],F=o[1],v=o[2],b=r[0],_=r[1],p=r[2];return Math.abs(d-b)<e.EPSILON&&Math.abs(m-_)<e.EPSILON&&Math.abs(I-p)<e.EPSILON?n.identity(t):(h=d-b,c=m-_,x=I-p,S=1/Math.sqrt(h*h+c*c+x*x),h*=S,c*=S,x*=S,u=F*x-v*c,i=v*h-D*x,l=D*c-F*h,S=Math.sqrt(u*u+i*i+l*l),S?(S=1/S,u*=S,i*=S,l*=S):(u=0,i=0,l=0),s=c*l-x*i,M=x*u-h*l,f=h*i-c*u,S=Math.sqrt(s*s+M*M+f*f),S?(S=1/S,s*=S,M*=S,f*=S):(s=0,M=0,f=0),t[0]=u,t[1]=s,t[2]=h,t[3]=0,t[4]=i,t[5]=M,t[6]=c,t[7]=0,t[8]=l,t[9]=f,t[10]=x,t[11]=0,t[12]=-(u*d+i*m+l*I),t[13]=-(s*d+M*m+f*I),t[14]=-(h*d+c*m+x*I),t[15]=1,t)},n.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},n.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},n.add=function(t,a,r){return t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t[3]=a[3]+r[3],t[4]=a[4]+r[4],t[5]=a[5]+r[5],t[6]=a[6]+r[6],t[7]=a[7]+r[7],t[8]=a[8]+r[8],t[9]=a[9]+r[9],t[10]=a[10]+r[10],t[11]=a[11]+r[11],t[12]=a[12]+r[12],t[13]=a[13]+r[13],t[14]=a[14]+r[14],t[15]=a[15]+r[15],t},n.subtract=function(t,a,r){return t[0]=a[0]-r[0],t[1]=a[1]-r[1],t[2]=a[2]-r[2],t[3]=a[3]-r[3],t[4]=a[4]-r[4],t[5]=a[5]-r[5],t[6]=a[6]-r[6],t[7]=a[7]-r[7],t[8]=a[8]-r[8],t[9]=a[9]-r[9],t[10]=a[10]-r[10],t[11]=a[11]-r[11],t[12]=a[12]-r[12],t[13]=a[13]-r[13],t[14]=a[14]-r[14],t[15]=a[15]-r[15],t},n.sub=n.subtract,n.multiplyScalar=function(t,a,r){return t[0]=a[0]*r,t[1]=a[1]*r,t[2]=a[2]*r,t[3]=a[3]*r,t[4]=a[4]*r,t[5]=a[5]*r,t[6]=a[6]*r,t[7]=a[7]*r,t[8]=a[8]*r,t[9]=a[9]*r,t[10]=a[10]*r,t[11]=a[11]*r,t[12]=a[12]*r,t[13]=a[13]*r,t[14]=a[14]*r,t[15]=a[15]*r,t},n.multiplyScalarAndAdd=function(t,a,r,e){return t[0]=a[0]+r[0]*e,t[1]=a[1]+r[1]*e,t[2]=a[2]+r[2]*e,t[3]=a[3]+r[3]*e,t[4]=a[4]+r[4]*e,t[5]=a[5]+r[5]*e,t[6]=a[6]+r[6]*e,t[7]=a[7]+r[7]*e,t[8]=a[8]+r[8]*e,t[9]=a[9]+r[9]*e,t[10]=a[10]+r[10]*e,t[11]=a[11]+r[11]*e,t[12]=a[12]+r[12]*e,t[13]=a[13]+r[13]*e,t[14]=a[14]+r[14]*e,t[15]=a[15]+r[15]*e,t},n.exactEquals=function(t,a){return t[0]===a[0]&&t[1]===a[1]&&t[2]===a[2]&&t[3]===a[3]&&t[4]===a[4]&&t[5]===a[5]&&t[6]===a[6]&&t[7]===a[7]&&t[8]===a[8]&&t[9]===a[9]&&t[10]===a[10]&&t[11]===a[11]&&t[12]===a[12]&&t[13]===a[13]&&t[14]===a[14]&&t[15]===a[15]},n.equals=function(t,a){var r=t[0],n=t[1],o=t[2],u=t[3],i=t[4],l=t[5],s=t[6],M=t[7],f=t[8],h=t[9],c=t[10],x=t[11],S=t[12],d=t[13],m=t[14],I=t[15],D=a[0],F=a[1],v=a[2],b=a[3],_=a[4],p=a[5],E=a[6],g=a[7],w=a[8],A=a[9],T=a[10],y=a[11],R=a[12],P=a[13],z=a[14],L=a[15];return Math.abs(r-D)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(D))&&Math.abs(n-F)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(F))&&Math.abs(o-v)<=e.EPSILON*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(u-b)<=e.EPSILON*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(i-_)<=e.EPSILON*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(l-p)<=e.EPSILON*Math.max(1,Math.abs(l),Math.abs(p))&&Math.abs(s-E)<=e.EPSILON*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(M-g)<=e.EPSILON*Math.max(1,Math.abs(M),Math.abs(g))&&Math.abs(f-w)<=e.EPSILON*Math.max(1,Math.abs(f),Math.abs(w))&&Math.abs(h-A)<=e.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(c-T)<=e.EPSILON*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(x-y)<=e.EPSILON*Math.max(1,Math.abs(x),Math.abs(y))&&Math.abs(S-R)<=e.EPSILON*Math.max(1,Math.abs(S),Math.abs(R))&&Math.abs(d-P)<=e.EPSILON*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(m-z)<=e.EPSILON*Math.max(1,Math.abs(m),Math.abs(z))&&Math.abs(I-L)<=e.EPSILON*Math.max(1,Math.abs(I),Math.abs(L));
},t.exports=n},function(t,a,r){var e=r(1),n=r(6),o=r(7),u=r(8),i={};i.create=function(){var t=new e.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},i.rotationTo=function(){var t=o.create(),a=o.fromValues(1,0,0),r=o.fromValues(0,1,0);return function(e,n,u){var l=o.dot(n,u);return l<-.999999?(o.cross(t,a,n),o.length(t)<1e-6&&o.cross(t,r,n),o.normalize(t,t),i.setAxisAngle(e,t,Math.PI),e):l>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(o.cross(t,n,u),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=1+l,i.normalize(e,e))}}(),i.setAxes=function(){var t=n.create();return function(a,r,e,n){return t[0]=e[0],t[3]=e[1],t[6]=e[2],t[1]=n[0],t[4]=n[1],t[7]=n[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],i.normalize(a,i.fromMat3(a,t))}}(),i.clone=u.clone,i.fromValues=u.fromValues,i.copy=u.copy,i.set=u.set,i.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},i.setAxisAngle=function(t,a,r){r*=.5;var e=Math.sin(r);return t[0]=e*a[0],t[1]=e*a[1],t[2]=e*a[2],t[3]=Math.cos(r),t},i.getAxisAngle=function(t,a){var r=2*Math.acos(a[3]),e=Math.sin(r/2);return 0!=e?(t[0]=a[0]/e,t[1]=a[1]/e,t[2]=a[2]/e):(t[0]=1,t[1]=0,t[2]=0),r},i.add=u.add,i.multiply=function(t,a,r){var e=a[0],n=a[1],o=a[2],u=a[3],i=r[0],l=r[1],s=r[2],M=r[3];return t[0]=e*M+u*i+n*s-o*l,t[1]=n*M+u*l+o*i-e*s,t[2]=o*M+u*s+e*l-n*i,t[3]=u*M-e*i-n*l-o*s,t},i.mul=i.multiply,i.scale=u.scale,i.rotateX=function(t,a,r){r*=.5;var e=a[0],n=a[1],o=a[2],u=a[3],i=Math.sin(r),l=Math.cos(r);return t[0]=e*l+u*i,t[1]=n*l+o*i,t[2]=o*l-n*i,t[3]=u*l-e*i,t},i.rotateY=function(t,a,r){r*=.5;var e=a[0],n=a[1],o=a[2],u=a[3],i=Math.sin(r),l=Math.cos(r);return t[0]=e*l-o*i,t[1]=n*l+u*i,t[2]=o*l+e*i,t[3]=u*l-n*i,t},i.rotateZ=function(t,a,r){r*=.5;var e=a[0],n=a[1],o=a[2],u=a[3],i=Math.sin(r),l=Math.cos(r);return t[0]=e*l+n*i,t[1]=n*l-e*i,t[2]=o*l+u*i,t[3]=u*l-o*i,t},i.calculateW=function(t,a){var r=a[0],e=a[1],n=a[2];return t[0]=r,t[1]=e,t[2]=n,t[3]=Math.sqrt(Math.abs(1-r*r-e*e-n*n)),t},i.dot=u.dot,i.lerp=u.lerp,i.slerp=function(t,a,r,e){var n,o,u,i,l,s=a[0],M=a[1],f=a[2],h=a[3],c=r[0],x=r[1],S=r[2],d=r[3];return o=s*c+M*x+f*S+h*d,o<0&&(o=-o,c=-c,x=-x,S=-S,d=-d),1-o>1e-6?(n=Math.acos(o),u=Math.sin(n),i=Math.sin((1-e)*n)/u,l=Math.sin(e*n)/u):(i=1-e,l=e),t[0]=i*s+l*c,t[1]=i*M+l*x,t[2]=i*f+l*S,t[3]=i*h+l*d,t},i.sqlerp=function(){var t=i.create(),a=i.create();return function(r,e,n,o,u,l){return i.slerp(t,e,u,l),i.slerp(a,n,o,l),i.slerp(r,t,a,2*l*(1-l)),r}}(),i.invert=function(t,a){var r=a[0],e=a[1],n=a[2],o=a[3],u=r*r+e*e+n*n+o*o,i=u?1/u:0;return t[0]=-r*i,t[1]=-e*i,t[2]=-n*i,t[3]=o*i,t},i.conjugate=function(t,a){return t[0]=-a[0],t[1]=-a[1],t[2]=-a[2],t[3]=a[3],t},i.length=u.length,i.len=i.length,i.squaredLength=u.squaredLength,i.sqrLen=i.squaredLength,i.normalize=u.normalize,i.fromMat3=function(t,a){var r,e=a[0]+a[4]+a[8];if(e>0)r=Math.sqrt(e+1),t[3]=.5*r,r=.5/r,t[0]=(a[5]-a[7])*r,t[1]=(a[6]-a[2])*r,t[2]=(a[1]-a[3])*r;else{var n=0;a[4]>a[0]&&(n=1),a[8]>a[3*n+n]&&(n=2);var o=(n+1)%3,u=(n+2)%3;r=Math.sqrt(a[3*n+n]-a[3*o+o]-a[3*u+u]+1),t[n]=.5*r,r=.5/r,t[3]=(a[3*o+u]-a[3*u+o])*r,t[o]=(a[3*o+n]+a[3*n+o])*r,t[u]=(a[3*u+n]+a[3*n+u])*r}return t},i.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},i.exactEquals=u.exactEquals,i.equals=u.equals,t.exports=i},function(t,a,r){var e=r(1),n={};n.create=function(){var t=new e.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},n.clone=function(t){var a=new e.ARRAY_TYPE(2);return a[0]=t[0],a[1]=t[1],a},n.fromValues=function(t,a){var r=new e.ARRAY_TYPE(2);return r[0]=t,r[1]=a,r},n.copy=function(t,a){return t[0]=a[0],t[1]=a[1],t},n.set=function(t,a,r){return t[0]=a,t[1]=r,t},n.add=function(t,a,r){return t[0]=a[0]+r[0],t[1]=a[1]+r[1],t},n.subtract=function(t,a,r){return t[0]=a[0]-r[0],t[1]=a[1]-r[1],t},n.sub=n.subtract,n.multiply=function(t,a,r){return t[0]=a[0]*r[0],t[1]=a[1]*r[1],t},n.mul=n.multiply,n.divide=function(t,a,r){return t[0]=a[0]/r[0],t[1]=a[1]/r[1],t},n.div=n.divide,n.ceil=function(t,a){return t[0]=Math.ceil(a[0]),t[1]=Math.ceil(a[1]),t},n.floor=function(t,a){return t[0]=Math.floor(a[0]),t[1]=Math.floor(a[1]),t},n.min=function(t,a,r){return t[0]=Math.min(a[0],r[0]),t[1]=Math.min(a[1],r[1]),t},n.max=function(t,a,r){return t[0]=Math.max(a[0],r[0]),t[1]=Math.max(a[1],r[1]),t},n.round=function(t,a){return t[0]=Math.round(a[0]),t[1]=Math.round(a[1]),t},n.scale=function(t,a,r){return t[0]=a[0]*r,t[1]=a[1]*r,t},n.scaleAndAdd=function(t,a,r,e){return t[0]=a[0]+r[0]*e,t[1]=a[1]+r[1]*e,t},n.distance=function(t,a){var r=a[0]-t[0],e=a[1]-t[1];return Math.sqrt(r*r+e*e)},n.dist=n.distance,n.squaredDistance=function(t,a){var r=a[0]-t[0],e=a[1]-t[1];return r*r+e*e},n.sqrDist=n.squaredDistance,n.length=function(t){var a=t[0],r=t[1];return Math.sqrt(a*a+r*r)},n.len=n.length,n.squaredLength=function(t){var a=t[0],r=t[1];return a*a+r*r},n.sqrLen=n.squaredLength,n.negate=function(t,a){return t[0]=-a[0],t[1]=-a[1],t},n.inverse=function(t,a){return t[0]=1/a[0],t[1]=1/a[1],t},n.normalize=function(t,a){var r=a[0],e=a[1],n=r*r+e*e;return n>0&&(n=1/Math.sqrt(n),t[0]=a[0]*n,t[1]=a[1]*n),t},n.dot=function(t,a){return t[0]*a[0]+t[1]*a[1]},n.cross=function(t,a,r){var e=a[0]*r[1]-a[1]*r[0];return t[0]=t[1]=0,t[2]=e,t},n.lerp=function(t,a,r,e){var n=a[0],o=a[1];return t[0]=n+e*(r[0]-n),t[1]=o+e*(r[1]-o),t},n.random=function(t,a){a=a||1;var r=2*e.RANDOM()*Math.PI;return t[0]=Math.cos(r)*a,t[1]=Math.sin(r)*a,t},n.transformMat2=function(t,a,r){var e=a[0],n=a[1];return t[0]=r[0]*e+r[2]*n,t[1]=r[1]*e+r[3]*n,t},n.transformMat2d=function(t,a,r){var e=a[0],n=a[1];return t[0]=r[0]*e+r[2]*n+r[4],t[1]=r[1]*e+r[3]*n+r[5],t},n.transformMat3=function(t,a,r){var e=a[0],n=a[1];return t[0]=r[0]*e+r[3]*n+r[6],t[1]=r[1]*e+r[4]*n+r[7],t},n.transformMat4=function(t,a,r){var e=a[0],n=a[1];return t[0]=r[0]*e+r[4]*n+r[12],t[1]=r[1]*e+r[5]*n+r[13],t},n.forEach=function(){var t=n.create();return function(a,r,e,n,o,u){var i,l;for(r||(r=2),e||(e=0),l=n?Math.min(n*r+e,a.length):a.length,i=e;i<l;i+=r)t[0]=a[i],t[1]=a[i+1],o(t,t,u),a[i]=t[0],a[i+1]=t[1];return a}}(),n.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},n.exactEquals=function(t,a){return t[0]===a[0]&&t[1]===a[1]},n.equals=function(t,a){var r=t[0],n=t[1],o=a[0],u=a[1];return Math.abs(r-o)<=e.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-u)<=e.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))},t.exports=n}]);